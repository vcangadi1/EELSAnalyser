clc
%% Solar cell
EELS = readEELSdata('/Users/veersaysit/Desktop/EELS data/InGaN/100kV/EELS Spectrum Image6-b.dm3');
%EELS = change_dimension(EELS,90,43);
l = EELS.energy_loss_axis;

EELZ = readEELSdata('/Users/veersaysit/Desktop/EELS data/InGaN/100kV/EELS Spectrum Image6-thickness-map.dm3');
%EELZ = change_dimension(EELZ,90,43);
EELZ = change_dispersion(EELZ,EELS.dispersion);
Optional_EELZ_low_loss = EELZ;

bstar = 45
%[f1, f2, bstar] = Concor2(16.6,15,l,197);

dfcCu = diffCS_L23(29,931,197,bstar,l);
dfcGa = diffCS_L23(31,1115,197,bstar,l);
dfcAs = diffCS_L23(33,1323,197,bstar,l);
Diff_cross_sections = [dfcCu, dfcGa, dfcAs];

model_begin_channel = eV2ch(l,850);
model_end_channel = eV2ch(l,929);
